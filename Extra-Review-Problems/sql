
select user_id, count(post_id) as Post_count from post
where extract( date from timestamp) - intraval '3 months' >0 
group by 1 
order by 2 desc 
limit 5


select country, 
extract( month from order_date),
 sum(order_amount) as  total_revenue from order o
 left join users u on o.user_id=u.user_id
 group by 1,2
 where order_date between 01-01-20024 and 30-03-2024


 with ranking_daily as (
 select extrat( date from stream_timestamp) as date,
 song_id,
 count(steam_id) as stream_count,
 ROW_NUMBER() over(partition by extrat( date from stream_timestamp) 
        order by count(steam_id) desc  ) as rnk
 from streams
group by 1,2
 )

 select date, song_id, steam_count
  from ranking_daily
where rnk <= 3
and date >= current_date() - interval '7 Day')
