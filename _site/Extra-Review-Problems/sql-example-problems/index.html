<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>SQL Practice Problems for Meta Data Science Interviews</title>
    <meta name="description" content="A handbook for preparing for analytical/data-science interviews">

    <!-- MathJax -->
    <script async src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">

    <!-- Site CSS -->
    <link rel="stylesheet" href="/assets/css/style.css">
  </head>
  <body>
    <aside class="sidebar">
  <h2>Contents</h2>
  <ul class="nav-list">
    <li><a href="/introduction/" class="">I. Introduction</a>
      <ul>
        <li><a href="/introduction/#welcome">1. Welcome and Purpose of this Handbook</a></li>
        <li><a href="/introduction/#meta-data-science-role">2. What to Expect: The Meta Data Science Role</a></li>
        <li><a href="/introduction/#interview-process">3. Navigating the Meta Interview Process</a></li>
        <li><a href="/introduction/#handbook-usage">4. How to Use This Handbook</a></li>
      </ul>
    </li>
    <li><a href="/foundational_knowledge/1/">II. Foundational Knowledge & Skills</a></li>
    <li><a href="/interview_preparation/technical_skills/">III. Interview Preparation</a></li>
    <li><a href="/meta_specificity/">IV. Meta Specificity</a></li>
    <li><a href="/resources_practice/">V. Resources and Practice</a></li>
    <li><a href="/conclusion/">VI. Conclusion</a></li>
    <li><a href="/appendix/">Appendix</a></li>
  </ul>
</aside>


    <main class="main-content">
      <h1 id="sql-practice-problems-for-meta-data-science-interviews">SQL Practice Problems for Meta Data Science Interviews</h1>

<p>This section provides complex SQL practice problems designed to simulate real-world scenarios at a social media company like Meta. These problems require a deeper understanding of SQL and analytical thinking. Solutions will be provided separately.</p>

<h2 id="problem-index">Problem Index</h2>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Problem</th>
      <th style="text-align: left">Difficulty</th>
      <th style="text-align: left">Type of Problem</th>
      <th style="text-align: left">Link</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">1</td>
      <td style="text-align: left">Medium</td>
      <td style="text-align: left">Joins, Aggregations</td>
      <td style="text-align: left"><a href="##problem-1-department-highest-salary">#problem-1-department-highest-salary</a></td>
    </tr>
    <tr>
      <td style="text-align: left">2</td>
      <td style="text-align: left">Medium</td>
      <td style="text-align: left">Self Joins, Consecutive Rows</td>
      <td style="text-align: left"><a href="##problem-2-consecutive-numbers">#problem-2-consecutive-numbers</a></td>
    </tr>
    <tr>
      <td style="text-align: left">3</td>
      <td style="text-align: left">Medium</td>
      <td style="text-align: left">Subqueries, NOT IN</td>
      <td style="text-align: left"><a href="##problem-3-customers-who-never-order">#problem-3-customers-who-never-order</a></td>
    </tr>
    <tr>
      <td style="text-align: left">4</td>
      <td style="text-align: left">Medium</td>
      <td style="text-align: left">Subqueries, MAX</td>
      <td style="text-align: left"><a href="##problem-4-second-highest-salary">#problem-4-second-highest-salary</a></td>
    </tr>
    <tr>
      <td style="text-align: left">5</td>
      <td style="text-align: left">Medium</td>
      <td style="text-align: left">Self Joins, Date Functions</td>
      <td style="text-align: left"><a href="##problem-5-rising-temperature">#problem-5-rising-temperature</a></td>
    </tr>
    <tr>
      <td style="text-align: left">6</td>
      <td style="text-align: left">Advanced</td>
      <td style="text-align: left">Joins, Aggregations, Dates</td>
      <td style="text-align: left"><a href="##problem-6-engagement-rate-by-content-type">#problem-6-engagement-rate-by-content-type</a></td>
    </tr>
    <tr>
      <td style="text-align: left">7</td>
      <td style="text-align: left">Advanced</td>
      <td style="text-align: left">Self Joins, Date Functions, Churn</td>
      <td style="text-align: left"><a href="##problem-7-churn-rate-by-user-segment">#problem-7-churn-rate-by-user-segment</a></td>
    </tr>
    <tr>
      <td style="text-align: left">8</td>
      <td style="text-align: left">Advanced</td>
      <td style="text-align: left">Self Joins, Date Differences</td>
      <td style="text-align: left"><a href="##problem-8-average-time-between-posts">#problem-8-average-time-between-posts</a></td>
    </tr>
    <tr>
      <td style="text-align: left">9</td>
      <td style="text-align: left">Advanced</td>
      <td style="text-align: left">String Manipulation, Window Functions, Dates</td>
      <td style="text-align: left"><a href="##problem-9-most-popular-hashtags-by-week">#problem-9-most-popular-hashtags-by-week</a></td>
    </tr>
    <tr>
      <td style="text-align: left">10</td>
      <td style="text-align: left">Advanced</td>
      <td style="text-align: left">Cohort Analysis, Date Functions</td>
      <td style="text-align: left"><a href="##problem-10-retained-users-by-cohort">#problem-10-retained-users-by-cohort</a></td>
    </tr>
    <tr>
      <td style="text-align: left">11</td>
      <td style="text-align: left">Advanced</td>
      <td style="text-align: left">Self Joins, Counting Connections</td>
      <td style="text-align: left"><a href="##problem-11-mutual-connections">#problem-11-mutual-connections</a></td>
    </tr>
    <tr>
      <td style="text-align: left">12</td>
      <td style="text-align: left">Advanced</td>
      <td style="text-align: left">Joins, Aggregations, Age Grouping</td>
      <td style="text-align: left"><a href="##problem-12-average-post-engagement-by-user-age-group">#problem-12-average-post-engagement-by-user-age-group</a></td>
    </tr>
    <tr>
      <td style="text-align: left">13</td>
      <td style="text-align: left">Advanced</td>
      <td style="text-align: left">Time Series Analysis, Percentage Change</td>
      <td style="text-align: left"><a href="##problem-13-trending-topics-over-time">#problem-13-trending-topics-over-time</a></td>
    </tr>
    <tr>
      <td style="text-align: left">14</td>
      <td style="text-align: left">Advanced</td>
      <td style="text-align: left">Funnel Analysis, Conversion Rates</td>
      <td style="text-align: left"><a href="##problem-14-user-engagement-funnel">#problem-14-user-engagement-funnel</a></td>
    </tr>
  </tbody>
</table>

<hr />
<div style="page-break-before: always;"></div>

<h2 id="problem-1-department-highest-salary-leetcode-184">Problem 1: Department Highest Salary (LeetCode 184)</h2>

<p><strong>Problem Statement:</strong> Write an SQL query to find employees who have the highest salary in each of their departments.</p>

<p><strong>Table Schema:</strong></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Employee</code> table:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">Id</code> (int): Primary key.</li>
      <li><code class="language-plaintext highlighter-rouge">Name</code> (varchar): Employee name.</li>
      <li><code class="language-plaintext highlighter-rouge">Salary</code> (int): Employee salary.</li>
      <li><code class="language-plaintext highlighter-rouge">DepartmentId</code> (int): Foreign key referencing the <code class="language-plaintext highlighter-rouge">Department</code> table.</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">Department</code> table:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">Id</code> (int): Primary key.</li>
      <li><code class="language-plaintext highlighter-rouge">Name</code> (varchar): Department name.</li>
    </ul>
  </li>
</ul>

<p><strong>Example:</strong></p>

<p><code class="language-plaintext highlighter-rouge">Employee</code> table:</p>

<table>
  <thead>
    <tr>
      <th>Id</th>
      <th>Name</th>
      <th>Salary</th>
      <th>DepartmentId</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>Joe</td>
      <td>70000</td>
      <td>1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Henry</td>
      <td>80000</td>
      <td>2</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Sam</td>
      <td>60000</td>
      <td>2</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Max</td>
      <td>90000</td>
      <td>1</td>
    </tr>
    <tr>
      <td>5</td>
      <td>Janet</td>
      <td>69000</td>
      <td>1</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Randy</td>
      <td>85000</td>
      <td>1</td>
    </tr>
  </tbody>
</table>

<p><code class="language-plaintext highlighter-rouge">Department</code> table:</p>

<table>
  <thead>
    <tr>
      <th>Id</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>IT</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Sales</td>
    </tr>
  </tbody>
</table>

<p><strong>Expected Output:</strong></p>

<table>
  <thead>
    <tr>
      <th>Department</th>
      <th>Employee</th>
      <th>Salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>IT</td>
      <td>Max</td>
      <td>90000</td>
    </tr>
    <tr>
      <td>Sales</td>
      <td>Henry</td>
      <td>80000</td>
    </tr>
  </tbody>
</table>

<hr />
<div style="page-break-before: always;"></div>

<h2 id="problem-2-consecutive-numbers-leetcode-180">Problem 2: Consecutive Numbers (LeetCode 180)</h2>

<p><strong>Problem Statement:</strong> Write an SQL query to find all numbers that appear at least three times consecutively.</p>

<p><strong>Table Schema:</strong></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Logs</code> table:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">Id</code> (int): Primary key.</li>
      <li><code class="language-plaintext highlighter-rouge">Num</code> (int): The number in the log.</li>
    </ul>
  </li>
</ul>

<p><strong>Example:</strong></p>

<p><code class="language-plaintext highlighter-rouge">Logs</code> table:</p>

<table>
  <thead>
    <tr>
      <th>Id</th>
      <th>Num</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <td>6</td>
      <td>2</td>
    </tr>
    <tr>
      <td>7</td>
      <td>2</td>
    </tr>
  </tbody>
</table>

<p><strong>Expected Output:</strong></p>

<table>
  <thead>
    <tr>
      <th>Num</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
    </tr>
  </tbody>
</table>

<hr />
<div style="page-break-before: always;"></div>

<h2 id="problem-3-customers-who-never-order-leetcode-183">Problem 3: Customers Who Never Order (LeetCode 183)</h2>

<p><strong>Problem Statement:</strong> Write an SQL query to find all customers who never place an order.</p>

<p><strong>Table Schema:</strong></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Customers</code> table:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">Id</code> (int): Primary key.</li>
      <li><code class="language-plaintext highlighter-rouge">Name</code> (varchar): Customer name.</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">Orders</code> table:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">Id</code> (int): Primary key.</li>
      <li><code class="language-plaintext highlighter-rouge">CustomerId</code> (int): Foreign key referencing the <code class="language-plaintext highlighter-rouge">Customers</code> table.</li>
    </ul>
  </li>
</ul>

<p><strong>Example:</strong></p>

<p><code class="language-plaintext highlighter-rouge">Customers</code> table:</p>

<table>
  <thead>
    <tr>
      <th>Id</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>Joe</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Henry</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Sam</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Max</td>
    </tr>
  </tbody>
</table>

<p><code class="language-plaintext highlighter-rouge">Orders</code> table:</p>

<table>
  <thead>
    <tr>
      <th>Id</th>
      <th>CustomerId</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>

<p><strong>Expected Output:</strong></p>

<table>
  <thead>
    <tr>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Henry</td>
    </tr>
    <tr>
      <td>Max</td>
    </tr>
  </tbody>
</table>

<hr />
<div style="page-break-before: always;"></div>

<h2 id="problem-4-second-highest-salary-leetcode-176">Problem 4: Second Highest Salary (LeetCode 176)</h2>

<p><strong>Problem Statement:</strong> Write an SQL query to get the second highest salary from the <code class="language-plaintext highlighter-rouge">Employee</code> table. If there is no second highest salary, then the query should return <code class="language-plaintext highlighter-rouge">null</code>.</p>

<p><strong>Table Schema:</strong></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Employee</code> table:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">Id</code> (int): Primary key.</li>
      <li><code class="language-plaintext highlighter-rouge">Salary</code> (int): Employee salary.</li>
    </ul>
  </li>
</ul>

<p><strong>Example:</strong></p>

<p><code class="language-plaintext highlighter-rouge">Employee</code> table:</p>

<table>
  <thead>
    <tr>
      <th>Id</th>
      <th>Salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>100</td>
    </tr>
    <tr>
      <td>2</td>
      <td>200</td>
    </tr>
    <tr>
      <td>3</td>
      <td>300</td>
    </tr>
  </tbody>
</table>

<p><strong>Expected Output:</strong></p>

<table>
  <thead>
    <tr>
      <th>SecondHighestSalary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>200</td>
    </tr>
  </tbody>
</table>

<hr />
<div style="page-break-before: always;"></div>

<h2 id="problem-5-rising-temperature-leetcode-197">Problem 5: Rising Temperature (LeetCode 197)</h2>

<p><strong>Problem Statement:</strong> Write an SQL query to find all dates’ <code class="language-plaintext highlighter-rouge">Id</code> with higher temperatures compared to its previous dates (yesterday’s dates).</p>

<p><strong>Table Schema:</strong></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Weather</code> table:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">Id</code> (int): Primary key.</li>
      <li><code class="language-plaintext highlighter-rouge">RecordDate</code> (date): Date of the weather record.</li>
      <li><code class="language-plaintext highlighter-rouge">Temperature</code> (int): Temperature on that day.</li>
    </ul>
  </li>
</ul>

<p><strong>Example:</strong></p>

<p><code class="language-plaintext highlighter-rouge">Weather</code> table:</p>

<table>
  <thead>
    <tr>
      <th>Id</th>
      <th>RecordDate</th>
      <th>Temperature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>2015-01-01</td>
      <td>10</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2015-01-02</td>
      <td>25</td>
    </tr>
    <tr>
      <td>3</td>
      <td>2015-01-03</td>
      <td>20</td>
    </tr>
    <tr>
      <td>4</td>
      <td>2015-01-04</td>
      <td>30</td>
    </tr>
  </tbody>
</table>

<p><strong>Expected Output:</strong></p>

<table>
  <thead>
    <tr>
      <th>Id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2</td>
    </tr>
    <tr>
      <td>4</td>
    </tr>
  </tbody>
</table>

<hr />
<div style="page-break-before: always;"></div>

<h2 id="problem-6-engagement-rate-by-content-type">Problem 6: Engagement Rate by Content Type</h2>

<p><strong>Problem Statement:</strong> You are a data scientist at a social media platform. The product team is considering investing in more video content. You need to analyze user engagement across different content types (photo, video, text) to determine if this is a worthwhile investment. Write an SQL query to calculate the average engagement rate (likes + comments + shares / impressions) for each content type, broken down by month.</p>

<p><strong>Table Schema:</strong></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Posts</code> table:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">post_id</code> (INT, PRIMARY KEY): Unique identifier for each post.</li>
      <li><code class="language-plaintext highlighter-rouge">user_id</code> (INT): ID of the user who created the post.</li>
      <li><code class="language-plaintext highlighter-rouge">content_type</code> (VARCHAR): Type of content (‘photo’, ‘video’, ‘text’).</li>
      <li><code class="language-plaintext highlighter-rouge">created_at</code> (TIMESTAMP): Timestamp of post creation.</li>
      <li><code class="language-plaintext highlighter-rouge">impressions</code> (INT): Number of times the post was shown to users.</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">Reactions</code> table:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">reaction_id</code> (INT, PRIMARY KEY): Unique identifier for each reaction.</li>
      <li><code class="language-plaintext highlighter-rouge">post_id</code> (INT): ID of the post that received the reaction.</li>
      <li><code class="language-plaintext highlighter-rouge">reaction_type</code> (VARCHAR): Type of reaction (‘like’, ‘comment’, ‘share’).</li>
    </ul>
  </li>
</ul>

<p><strong>Example:</strong> (Simplified for brevity)</p>

<p><code class="language-plaintext highlighter-rouge">Posts</code> table:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">post_id</th>
      <th style="text-align: left">user_id</th>
      <th style="text-align: left">content_type</th>
      <th style="text-align: left">created_at</th>
      <th style="text-align: left">impressions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">1</td>
      <td style="text-align: left">101</td>
      <td style="text-align: left">photo</td>
      <td style="text-align: left">2024-01-15 10:00:00</td>
      <td style="text-align: left">1000</td>
    </tr>
    <tr>
      <td style="text-align: left">2</td>
      <td style="text-align: left">102</td>
      <td style="text-align: left">video</td>
      <td style="text-align: left">2024-01-20 12:00:00</td>
      <td style="text-align: left">500</td>
    </tr>
    <tr>
      <td style="text-align: left">3</td>
      <td style="text-align: left">101</td>
      <td style="text-align: left">text</td>
      <td style="text-align: left">2024-02-01 09:00:00</td>
      <td style="text-align: left">2000</td>
    </tr>
    <tr>
      <td style="text-align: left">4</td>
      <td style="text-align: left">103</td>
      <td style="text-align: left">video</td>
      <td style="text-align: left">2024-02-10 15:00:00</td>
      <td style="text-align: left">1500</td>
    </tr>
  </tbody>
</table>

<p><code class="language-plaintext highlighter-rouge">Reactions</code> table:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">reaction_id</th>
      <th style="text-align: left">post_id</th>
      <th style="text-align: left">reaction_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">1</td>
      <td style="text-align: left">1</td>
      <td style="text-align: left">like</td>
    </tr>
    <tr>
      <td style="text-align: left">2</td>
      <td style="text-align: left">1</td>
      <td style="text-align: left">comment</td>
    </tr>
    <tr>
      <td style="text-align: left">3</td>
      <td style="text-align: left">2</td>
      <td style="text-align: left">like</td>
    </tr>
    <tr>
      <td style="text-align: left">4</td>
      <td style="text-align: left">2</td>
      <td style="text-align: left">share</td>
    </tr>
    <tr>
      <td style="text-align: left">5</td>
      <td style="text-align: left">3</td>
      <td style="text-align: left">comment</td>
    </tr>
    <tr>
      <td style="text-align: left">6</td>
      <td style="text-align: left">4</td>
      <td style="text-align: left">like</td>
    </tr>
    <tr>
      <td style="text-align: left">7</td>
      <td style="text-align: left">4</td>
      <td style="text-align: left">like</td>
    </tr>
    <tr>
      <td style="text-align: left">8</td>
      <td style="text-align: left">4</td>
      <td style="text-align: left">share</td>
    </tr>
  </tbody>
</table>

<p><strong>Expected Output (Conceptual):</strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">month</th>
      <th style="text-align: left">content_type</th>
      <th style="text-align: left">avg_engagement_rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">2024-01</td>
      <td style="text-align: left">photo</td>
      <td style="text-align: left">0.002</td>
    </tr>
    <tr>
      <td style="text-align: left">2024-01</td>
      <td style="text-align: left">video</td>
      <td style="text-align: left">0.004</td>
    </tr>
    <tr>
      <td style="text-align: left">2024-02</td>
      <td style="text-align: left">text</td>
      <td style="text-align: left">0.0005</td>
    </tr>
    <tr>
      <td style="text-align: left">2024-02</td>
      <td style="text-align: left">video</td>
      <td style="text-align: left">0.00133</td>
    </tr>
  </tbody>
</table>

<hr />

<div style="page-break-before: always;"></div>

<h2 id="problem-7-churn-rate-by-user-segment">Problem 7: Churn Rate by User Segment</h2>

<p><strong>Problem Statement:</strong> You are tasked with analyzing user churn. Calculate the churn rate for different user segments based on their signup date (users who signed up in the first half of the month vs. the second half). Churn is defined as users who were active in the previous month but did not have any activity in the current month.</p>

<p><strong>Table Schema:</strong></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Users</code> table:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">user_id</code> (INT, PRIMARY KEY): Unique identifier for each user.</li>
      <li><code class="language-plaintext highlighter-rouge">signup_date</code> (DATE): Date when the user signed up.</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">UserActivity</code> table:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">user_id</code> (INT): ID of the user.</li>
      <li><code class="language-plaintext highlighter-rouge">activity_date</code> (DATE): Date of user activity.</li>
    </ul>
  </li>
</ul>

<p><strong>Example:</strong> (Simplified)</p>

<p><code class="language-plaintext highlighter-rouge">Users</code> table:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">user_id</th>
      <th style="text-align: left">signup_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">1</td>
      <td style="text-align: left">2024-01-05</td>
    </tr>
    <tr>
      <td style="text-align: left">2</td>
      <td style="text-align: left">2024-01-20</td>
    </tr>
    <tr>
      <td style="text-align: left">3</td>
      <td style="text-align: left">2024-02-02</td>
    </tr>
    <tr>
      <td style="text-align: left">4</td>
      <td style="text-align: left">2024-02-18</td>
    </tr>
  </tbody>
</table>

<p><code class="language-plaintext highlighter-rouge">UserActivity</code> table:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">user_id</th>
      <th style="text-align: left">activity_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">1</td>
      <td style="text-align: left">2024-01-10</td>
    </tr>
    <tr>
      <td style="text-align: left">1</td>
      <td style="text-align: left">2024-02-05</td>
    </tr>
    <tr>
      <td style="text-align: left">2</td>
      <td style="text-align: left">2024-01-25</td>
    </tr>
    <tr>
      <td style="text-align: left">3</td>
      <td style="text-align: left">2024-02-15</td>
    </tr>
  </tbody>
</table>

<p><strong>Expected Output (Conceptual for February 2024):</strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">signup_segment</th>
      <th style="text-align: left">churn_rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">First Half</td>
      <td style="text-align: left">0.0</td>
    </tr>
    <tr>
      <td style="text-align: left">Second Half</td>
      <td style="text-align: left">1.0</td>
    </tr>
  </tbody>
</table>

<hr />

<div style="page-break-before: always;"></div>

<h2 id="problem-8-average-time-between-posts">Problem 8: Average Time Between Posts</h2>

<p><strong>Problem Statement:</strong> Analyze how frequently users post. Calculate the average time (in days) between posts for users who have made at least two posts.</p>

<p><strong>Table Schema:</strong></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Posts</code> table:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">post_id</code> (INT, PRIMARY KEY): Unique identifier for each post.</li>
      <li><code class="language-plaintext highlighter-rouge">user_id</code> (INT): ID of the user who created the post.</li>
      <li><code class="language-plaintext highlighter-rouge">created_at</code> (TIMESTAMP): Timestamp of post creation.</li>
    </ul>
  </li>
</ul>

<p><strong>Example:</strong></p>

<p><code class="language-plaintext highlighter-rouge">Posts</code> table:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">post_id</th>
      <th style="text-align: left">user_id</th>
      <th style="text-align: left">created_at</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">1</td>
      <td style="text-align: left">101</td>
      <td style="text-align: left">2024-01-01 10:00:00</td>
    </tr>
    <tr>
      <td style="text-align: left">2</td>
      <td style="text-align: left">101</td>
      <td style="text-align: left">2024-01-05 12:00:00</td>
    </tr>
    <tr>
      <td style="text-align: left">3</td>
      <td style="text-align: left">102</td>
      <td style="text-align: left">2024-01-10 15:00:00</td>
    </tr>
    <tr>
      <td style="text-align: left">4</td>
      <td style="text-align: left">101</td>
      <td style="text-align: left">2024-01-12 08:00:00</td>
    </tr>
  </tbody>
</table>

<p><strong>Expected Output:</strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">user_id</th>
      <th style="text-align: left">avg_days_between_posts</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">101</td>
      <td style="text-align: left">3</td>
    </tr>
  </tbody>
</table>

<hr />

<div style="page-break-before: always;"></div>

<h2 id="problem-9-most-popular-hashtags-by-week">Problem 9: Most Popular Hashtags by Week</h2>

<p><strong>Problem Statement:</strong> Determine the most popular hashtags used each week. “Popularity” is defined by the number of posts containing the hashtag.</p>

<p><strong>Table Schema:</strong></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Posts</code> table:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">post_id</code> (INT, PRIMARY KEY): Unique identifier for each post.</li>
      <li><code class="language-plaintext highlighter-rouge">content</code> (TEXT): The content of the post (may contain hashtags).</li>
      <li><code class="language-plaintext highlighter-rouge">created_at</code> (TIMESTAMP): Timestamp of post creation.</li>
    </ul>
  </li>
</ul>

<p><strong>Example:</strong></p>

<p><code class="language-plaintext highlighter-rouge">Posts</code> table:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">post_id</th>
      <th style="text-align: left">content</th>
      <th style="text-align: left">created_at</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">1</td>
      <td style="text-align: left">Check out this #amazing pic</td>
      <td style="text-align: left">2024-01-01 10:00:00</td>
    </tr>
    <tr>
      <td style="text-align: left">2</td>
      <td style="text-align: left">Another #amazing day</td>
      <td style="text-align: left">2024-01-03 12:00:00</td>
    </tr>
    <tr>
      <td style="text-align: left">3</td>
      <td style="text-align: left">Just a #random thought</td>
      <td style="text-align: left">2024-01-08 15:00:00</td>
    </tr>
    <tr>
      <td style="text-align: left">4</td>
      <td style="text-align: left">#amazing view</td>
      <td style="text-align: left">2024-01-10 08:00:00</td>
    </tr>
  </tbody>
</table>

<p><strong>Expected Output (Conceptual - assuming week starts on Monday):</strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">week_start</th>
      <th style="text-align: left">hashtag</th>
      <th style="text-align: left">post_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">2023-12-31</td>
      <td style="text-align: left">#amazing</td>
      <td style="text-align: left">2</td>
    </tr>
    <tr>
      <td style="text-align: left">2024-01-07</td>
      <td style="text-align: left">#random</td>
      <td style="text-align: left">1</td>
    </tr>
  </tbody>
</table>

<hr />

<div style="page-break-before: always;"></div>

<h2 id="problem-10-retained-users-by-cohort">Problem 10: Retained Users by Cohort</h2>

<p><strong>Problem Statement:</strong> Analyze user retention by cohort. A cohort is defined by the month a user signed up. Calculate the percentage of users from each cohort who are still active (have at least one activity) in the current month (let’s assume it’s March 2024 for this example).</p>

<p><strong>Table Schema:</strong></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Users</code> table:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">user_id</code> (INT, PRIMARY KEY): Unique identifier for each user.</li>
      <li><code class="language-plaintext highlighter-rouge">signup_date</code> (DATE): Date when the user signed up.</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">UserActivity</code> table:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">user_id</code> (INT): ID of the user.</li>
      <li><code class="language-plaintext highlighter-rouge">activity_date</code> (DATE): Date of user activity.</li>
    </ul>
  </li>
</ul>

<p><strong>Example:</strong></p>

<p><code class="language-plaintext highlighter-rouge">Users</code> table:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">user_id</th>
      <th style="text-align: left">signup_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">1</td>
      <td style="text-align: left">2024-01-15</td>
    </tr>
    <tr>
      <td style="text-align: left">2</td>
      <td style="text-align: left">2024-01-28</td>
    </tr>
    <tr>
      <td style="text-align: left">3</td>
      <td style="text-align: left">2024-02-05</td>
    </tr>
    <tr>
      <td style="text-align: left">4</td>
      <td style="text-align: left">2024-02-20</td>
    </tr>
    <tr>
      <td style="text-align: left">5</td>
      <td style="text-align: left">2024-03-10</td>
    </tr>
  </tbody>
</table>

<p><code class="language-plaintext highlighter-rouge">UserActivity</code> table:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">user_id</th>
      <th style="text-align: left">activity_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">1</td>
      <td style="text-align: left">2024-01-20</td>
    </tr>
    <tr>
      <td style="text-align: left">1</td>
      <td style="text-align: left">2024-03-01</td>
    </tr>
    <tr>
      <td style="text-align: left">2</td>
      <td style="text-align: left">2024-01-30</td>
    </tr>
    <tr>
      <td style="text-align: left">3</td>
      <td style="text-align: left">2024-02-10</td>
    </tr>
    <tr>
      <td style="text-align: left">3</td>
      <td style="text-align: left">2024-03-15</td>
    </tr>
    <tr>
      <td style="text-align: left">5</td>
      <td style="text-align: left">2024-03-20</td>
    </tr>
  </tbody>
</table>

<p><strong>Expected Output (for March 2024):</strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">signup_month</th>
      <th style="text-align: left">retention_rate</th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">2024-01</td>
      <td style="text-align: left">50.0</td>
      <td>(1 out of 2 Jan users active in Mar)</td>
    </tr>
    <tr>
      <td style="text-align: left">2024-02</td>
      <td style="text-align: left">50.0</td>
      <td>(1 out of 2 Feb users active in Mar)</td>
    </tr>
    <tr>
      <td style="text-align: left">2024-03</td>
      <td style="text-align: left">100.0</td>
      <td>(1 out of 1 Mar users active in Mar)</td>
    </tr>
  </tbody>
</table>

<p><strong>Clarification:</strong></p>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">signup_month</code> should be formatted as ‘YYYY-MM’.</li>
  <li>The <code class="language-plaintext highlighter-rouge">retention_rate</code> should be a percentage (e.g., 50.0, 75.0, 100.0).</li>
  <li>If a cohort has no users active in the current month, the retention rate should be 0.0.</li>
</ul>

<hr />

<div style="page-break-before: always;"></div>

<h2 id="problem-11-mutual-connections">Problem 11: Mutual Connections</h2>

<p><strong>Problem Statement:</strong> You are analyzing user connections on the platform. Write an SQL query to find all pairs of users who have at least three mutual connections.</p>

<p><strong>Table Schema:</strong></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Connections</code> table:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">user_id1</code> (INT): ID of the first user in the connection.</li>
      <li><code class="language-plaintext highlighter-rouge">user_id2</code> (INT): ID of the second user in the connection.</li>
      <li>(Note: Connections are undirected, meaning if (1, 2) exists, (2, 1) does not need to exist. You should treat them as the same connection.)</li>
    </ul>
  </li>
</ul>

<p><strong>Example:</strong></p>

<p><code class="language-plaintext highlighter-rouge">Connections</code> table:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">user_id1</th>
      <th style="text-align: left">user_id2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">1</td>
      <td style="text-align: left">2</td>
    </tr>
    <tr>
      <td style="text-align: left">1</td>
      <td style="text-align: left">3</td>
    </tr>
    <tr>
      <td style="text-align: left">1</td>
      <td style="text-align: left">4</td>
    </tr>
    <tr>
      <td style="text-align: left">2</td>
      <td style="text-align: left">3</td>
    </tr>
    <tr>
      <td style="text-align: left">2</td>
      <td style="text-align: left">4</td>
    </tr>
    <tr>
      <td style="text-align: left">2</td>
      <td style="text-align: left">5</td>
    </tr>
    <tr>
      <td style="text-align: left">3</td>
      <td style="text-align: left">4</td>
    </tr>
    <tr>
      <td style="text-align: left">3</td>
      <td style="text-align: left">5</td>
    </tr>
    <tr>
      <td style="text-align: left">4</td>
      <td style="text-align: left">5</td>
    </tr>
  </tbody>
</table>

<p><strong>Expected Output:</strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">user1</th>
      <th style="text-align: left">user2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">2</td>
      <td style="text-align: left">3</td>
    </tr>
    <tr>
      <td style="text-align: left">2</td>
      <td style="text-align: left">4</td>
    </tr>
    <tr>
      <td style="text-align: left">2</td>
      <td style="text-align: left">5</td>
    </tr>
    <tr>
      <td style="text-align: left">3</td>
      <td style="text-align: left">4</td>
    </tr>
    <tr>
      <td style="text-align: left">3</td>
      <td style="text-align: left">5</td>
    </tr>
    <tr>
      <td style="text-align: left">4</td>
      <td style="text-align: left">5</td>
    </tr>
  </tbody>
</table>

<p>(Users 2, 3, and 4 have 3 mutual connections with user 5)</p>

<hr />

<div style="page-break-before: always;"></div>

<h2 id="problem-12-average-post-engagement-by-user-age-group">Problem 12: Average Post Engagement by User Age Group</h2>

<p><strong>Problem Statement:</strong> You are analyzing post engagement based on user demographics. Calculate the average number of likes, comments, and shares per post for different user age groups (e.g., 18-24, 25-34, 35+).</p>

<p><strong>Table Schema:</strong></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Users</code> table:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">user_id</code> (INT, PRIMARY KEY): Unique identifier for each user.</li>
      <li><code class="language-plaintext highlighter-rouge">age</code> (INT): User’s age.</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">Posts</code> table:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">post_id</code> (INT, PRIMARY KEY): Unique identifier for each post.</li>
      <li><code class="language-plaintext highlighter-rouge">user_id</code> (INT): ID of the user who created the post.</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">Reactions</code> table:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">reaction_id</code> (INT, PRIMARY KEY): Unique identifier for each reaction.</li>
      <li><code class="language-plaintext highlighter-rouge">post_id</code> (INT): ID of the post that received the reaction.</li>
      <li><code class="language-plaintext highlighter-rouge">reaction_type</code> (VARCHAR): Type of reaction (‘like’, ‘comment’, ‘share’).</li>
    </ul>
  </li>
</ul>

<p><strong>Example:</strong> (Simplified)</p>

<p>(Example data would be provided similarly to previous problems)</p>

<p><strong>Expected Output (Conceptual):</strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">age_group</th>
      <th style="text-align: left">avg_likes</th>
      <th style="text-align: left">avg_comments</th>
      <th style="text-align: left">avg_shares</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">18-24</td>
      <td style="text-align: left">10.5</td>
      <td style="text-align: left">2.2</td>
      <td style="text-align: left">1.1</td>
    </tr>
    <tr>
      <td style="text-align: left">25-34</td>
      <td style="text-align: left">15.2</td>
      <td style="text-align: left">3.8</td>
      <td style="text-align: left">2.5</td>
    </tr>
    <tr>
      <td style="text-align: left">35+</td>
      <td style="text-align: left">8.7</td>
      <td style="text-align: left">1.5</td>
      <td style="text-align: left">0.8</td>
    </tr>
  </tbody>
</table>

<hr />

<div style="page-break-before: always;"></div>

<h2 id="problem-13-trending-topics-over-time">Problem 13: Trending Topics Over Time</h2>

<p><strong>Problem Statement:</strong> Identify trending topics on the platform over time. A topic is represented by a keyword. A topic is considered trending in a given week if its usage (number of posts containing the keyword) increases by at least 20% compared to the previous week.</p>

<p><strong>Table Schema:</strong></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Posts</code> table:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">post_id</code> (INT, PRIMARY KEY): Unique identifier for each post.</li>
      <li><code class="language-plaintext highlighter-rouge">content</code> (TEXT): The content of the post.</li>
      <li><code class="language-plaintext highlighter-rouge">created_at</code> (TIMESTAMP): Timestamp of post creation.</li>
    </ul>
  </li>
</ul>

<p><strong>Example:</strong> (Simplified)</p>

<p>(Example data would be provided similarly to previous problems)</p>

<p><strong>Expected Output (Conceptual - assuming week starts on Monday):</strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">week_start</th>
      <th style="text-align: left">keyword</th>
      <th style="text-align: left">percent_increase</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">2024-01-07</td>
      <td style="text-align: left">#newtopic</td>
      <td style="text-align: left">25.0</td>
    </tr>
  </tbody>
</table>

<hr />

<div style="page-break-before: always;"></div>

<h2 id="problem-14-user-engagement-funnel">Problem 14: User Engagement Funnel</h2>

<p><strong>Problem Statement:</strong> Analyze the user engagement funnel for a specific feature (e.g., creating a story). Calculate the conversion rates between different stages of the funnel:</p>

<ol>
  <li>Viewed the feature introduction.</li>
  <li>Started creating a story.</li>
  <li>Successfully posted a story.</li>
</ol>

<p><strong>Table Schema:</strong></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">UserActions</code> table:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">user_id</code> (INT): ID of the user.</li>
      <li><code class="language-plaintext highlighter-rouge">action</code> (VARCHAR): Type of user action (‘viewed_story_intro’, ‘started_story_creation’, ‘posted_story’).</li>
      <li><code class="language-plaintext highlighter-rouge">action_timestamp</code> (TIMESTAMP): Timestamp of the action.</li>
    </ul>
  </li>
</ul>

<p><strong>Example:</strong> (Simplified)</p>

<p>(Example data would be provided similarly to previous problems)</p>

<p><strong>Expected Output (Conceptual):</strong></p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">stage</th>
      <th style="text-align: left">conversion_rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Viewed Intro -&gt; Started Creation</td>
      <td style="text-align: left">60.0</td>
    </tr>
    <tr>
      <td style="text-align: left">Started Creation -&gt; Posted Story</td>
      <td style="text-align: left">75.0</td>
    </tr>
  </tbody>
</table>

      <footer>
        <p>© 2025 </p>
      </footer>
    </main>
  </body>
</html>
